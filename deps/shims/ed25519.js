/* esm.sh - esbuild bundle(@noble/ed25519@2.0.0) es2022 production */
var y=2n**255n-19n,E=2n**252n+27742317777372353535851937790883648493n,O=0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,C=0x6666666666666666666666666666666666666666666666666666666666666658n,H={a:-1n,d:37095705934669439343138083508754565189542113879843219016388785533085940283555n,p:y,n:E,h:8,Gx:O,Gy:C},p=(n="")=>{throw new Error(n)},J=n=>typeof n=="string",Y=(n,t)=>!(n instanceof Uint8Array)||typeof t=="number"&&t>0&&n.length!==t?p("Uint8Array expected"):n,Z=n=>new Uint8Array(n),B=(n,t)=>Y(J(n)?I(n):Z(n),t),c=(n,t=y)=>{let s=n%t;return s>=0n?s:t+s},q=n=>n instanceof h?n:p("Point expected"),D,h=class{constructor(t,s,e,r){this.ex=t,this.ey=s,this.ez=e,this.et=r}static fromAffine(t){return new h(t.x,t.y,1n,c(t.x*t.y))}static fromHex(t,s=!0){let{d:e}=H;t=B(t,32);let r=t.slice();r[31]=t[31]&-129;let o=K(r);o===0n||(s&&!(0n<o&&o<y)&&p("bad y coord 1"),!s&&!(0n<o&&o<2n**256n)&&p("bad y coord 2"));let i=c(o*o),l=c(i-1n),f=c(e*i+1n),{isValid:d,value:a}=lt(l,f);d||p("bad y coordinate 3");let u=(a&1n)===1n;return(t[31]&128)!==0!==u&&(a=c(-a)),new h(a,o,1n,c(a*o))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(t){let{ex:s,ey:e,ez:r}=this,{ex:o,ey:i,ez:l}=q(t),f=c(s*l),d=c(o*r),a=c(e*l),u=c(i*r);return f===d&&a===u}is0(){return this.equals(T)}negate(){return new h(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){let{ex:t,ey:s,ez:e}=this,{a:r}=H,o=c(t*t),i=c(s*s),l=c(2n*c(e*e)),f=c(r*o),d=t+s,a=c(c(d*d)-o-i),u=f+i,b=u-l,m=f-i,A=c(a*b),R=c(u*m),v=c(a*m),z=c(b*u);return new h(A,R,z,v)}add(t){let{ex:s,ey:e,ez:r,et:o}=this,{ex:i,ey:l,ez:f,et:d}=q(t),{a,d:u}=H,b=c(s*i),m=c(e*l),A=c(o*u*d),R=c(r*f),v=c((s+e)*(i+l)-b-m),z=c(R-A),j=c(R+A),k=c(m-a*b),ot=c(v*z),ct=c(j*k),rt=c(v*k),it=c(z*j);return new h(ot,ct,it,rt)}mul(t,s=!0){if(t===0n)return s===!0?p("cannot multiply by 0"):T;if(typeof t=="bigint"&&0n<t&&t<E||p("invalid scalar, must be < L"),!s&&this.is0()||t===1n)return this;if(this.equals(w))return ft(t).p;let e=T,r=w;for(let o=this;t>0n;o=o.double(),t>>=1n)t&1n?e=e.add(o):s&&(r=r.add(o));return e}multiply(t){return this.mul(t)}clearCofactor(){return this.mul(BigInt(H.h),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let t=this.mul(E/2n,!1).double();return E%2n&&(t=t.add(this)),t.is0()}toAffine(){let{ex:t,ey:s,ez:e}=this;if(this.is0())return{x:0n,y:0n};let r=tt(e);return c(e*r)!==1n&&p("invalid inverse"),{x:c(t*r),y:c(s*r)}}toRawBytes(){let{x:t,y:s}=this.toAffine(),e=$(s);return e[31]|=t&1n?128:0,e}toHex(){return G(this.toRawBytes())}};h.BASE=new h(O,C,1n,c(O*C));h.ZERO=new h(0n,1n,1n,0n);var{BASE:w,ZERO:T}=h,Q=(n,t)=>n.toString(16).padStart(t,"0"),G=n=>Array.from(n).map(t=>Q(t,2)).join(""),I=n=>{let t=n.length;(!J(n)||t%2)&&p("hex invalid 1");let s=Z(t/2);for(let e=0;e<s.length;e++){let r=e*2,o=n.slice(r,r+2),i=Number.parseInt(o,16);(Number.isNaN(i)||i<0)&&p("hex invalid 2"),s[e]=i}return s},$=n=>I(Q(n,32*2)).reverse(),K=n=>BigInt("0x"+G(Z(Y(n)).reverse())),S=(...n)=>{let t=Z(n.reduce((e,r)=>e+Y(r).length,0)),s=0;return n.forEach(e=>{t.set(e,s),s+=e.length}),t},tt=(n,t=y)=>{(n===0n||t<=0n)&&p("no inverse n="+n+" mod="+t);let s=c(n,t),e=t,r=0n,o=1n,i=1n,l=0n;for(;s!==0n;){let f=e/s,d=e%s,a=r-i*f,u=o-l*f;e=s,s=d,r=i,o=l,i=a,l=u}return e===1n?c(r,t):p("no inverse")},x=(n,t)=>{let s=n;for(;t-- >0n;)s*=s,s%=y;return s},at=n=>{let s=n*n%y*n%y,e=x(s,2n)*s%y,r=x(e,1n)*n%y,o=x(r,5n)*r%y,i=x(o,10n)*o%y,l=x(i,20n)*i%y,f=x(l,40n)*l%y,d=x(f,80n)*f%y,a=x(d,80n)*f%y,u=x(a,10n)*o%y;return{pow_p_5_8:x(u,2n)*n%y,b2:s}},M=19681161376707505956807079304988542015446066515923890162744021073123829784752n,lt=(n,t)=>{let s=c(t*t*t),e=c(s*s*t),r=at(n*e).pow_p_5_8,o=c(n*s*r),i=c(t*o*o),l=o,f=c(o*M),d=i===n,a=i===c(-n),u=i===c(-n*M);return d&&(o=l),(a||u)&&(o=f),(c(o)&1n)===1n&&(o=c(-o)),{isValid:d||a,value:o}},X=n=>c(K(n),E),_,F=(...n)=>V.sha512Async(...n),L=(...n)=>typeof _=="function"?_(...n):p("etc.sha512Sync not set"),nt=n=>{let t=n.slice(0,32);t[0]&=248,t[31]&=127,t[31]|=64;let s=n.slice(32,64),e=X(t),r=w.mul(e),o=r.toRawBytes();return{head:t,prefix:s,scalar:e,point:r,pointBytes:o}},P=n=>F(B(n,32)).then(nt),U=n=>nt(L(B(n,32))),dt=n=>P(n).then(t=>t.pointBytes),yt=n=>U(n).pointBytes;function N(n,t){return n?F(t.hashable).then(t.finish):t.finish(L(t.hashable))}var st=(n,t,s)=>{let{pointBytes:e,scalar:r}=n,o=X(t),i=w.mul(o).toRawBytes();return{hashable:S(i,e,s),finish:d=>{let a=c(o+X(d)*r,E);return Y(S(i,$(a)),64)}}},ht=async(n,t)=>{let s=B(n),e=await P(t),r=await F(e.prefix,s);return N(!0,st(e,r,s))},bt=(n,t)=>{let s=B(n),e=U(t),r=L(e.prefix,s);return N(!1,st(e,r,s))},et=(n,t,s)=>{t=B(t),n=B(n,64);let e=h.fromHex(s,!1),r=h.fromHex(n.slice(0,32),!1),o=K(n.slice(32,64)),i=w.mul(o,!1);return{hashable:S(r.toRawBytes(),e.toRawBytes(),t),finish:d=>{let a=X(d);return r.add(e.mul(a,!1)).add(i.negate()).clearCofactor().is0()}}},pt=async(n,t,s)=>N(!0,et(n,t,s)),xt=(n,t,s)=>N(!1,et(n,t,s)),W=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,V={bytesToHex:G,hexToBytes:I,concatBytes:S,mod:c,invert:tt,randomBytes:n=>{let t=W();return t||p("crypto.getRandomValues must be defined"),t.getRandomValues(Z(n))},sha512Async:async(...n)=>{let t=W();t||p("crypto.subtle or etc.sha512Async must be defined");let s=S(...n);return Z(await t.subtle.digest("SHA-512",s.buffer))},sha512Sync:void 0};Object.defineProperties(V,{sha512Sync:{configurable:!1,get(){return _},set(n){_||(_=n)}}});var wt={getExtendedPublicKeyAsync:P,getExtendedPublicKey:U,randomPrivateKey:()=>V.randomBytes(32),precompute(n=8,t=w){return t.multiply(3n),t}},g=8,ut=()=>{let n=[],t=256/g+1,s=w,e=s;for(let r=0;r<t;r++){e=s,n.push(e);for(let o=1;o<2**(g-1);o++)e=e.add(s),n.push(e);s=e.double()}return n},ft=n=>{let t=D||(D=ut()),s=(a,u)=>{let b=u.negate();return a?b:u},e=T,r=w,o=1+256/g,i=2**(g-1),l=BigInt(2**g-1),f=2**g,d=BigInt(g);for(let a=0;a<o;a++){let u=a*i,b=Number(n&l);n>>=d,b>i&&(b-=f,n+=1n);let m=u,A=u+Math.abs(b)-1,R=a%2!==0,v=b<0;b===0?r=r.add(s(R,t[m])):e=e.add(s(v,t[A]))}return{p:e,f:r}};export{H as CURVE,h as ExtendedPoint,V as etc,yt as getPublicKey,dt as getPublicKeyAsync,bt as sign,ht as signAsync,wt as utils,xt as verify,pt as verifyAsync};
/*! Bundled license information:

@noble/ed25519/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/